自用重构版advancedplus。
